package DataLayer.DataAccessLayer;

import java.util.ArrayList;
import java.util.Calendar;
import java.util.concurrent.Callable;

import DataLayer.Data;
import DataLayer.Components.CustomerData;
import DataLayer.Components.Rental;
import DataLayer.Components.Type;
import DataLayer.Components.Video;

public class DataOperationsImpl implements IDataOperations {

	//obiekt przchowuj¹cy wszystkie dane
	Data data = new Data();
	
	@Override
	public boolean addRental(ArrayList<Video> videos, CustomerData customer) {
		try{
			Rental newOne = new Rental();
			newOne.setCustomer(customer);
			newOne.setVideos(videos);
			data.rentals.add(newOne);
		}catch(Exception e) {
			return false;
		}
		return true;
	}
	
	//usuñ podany w parametrze obiekt wypo¿yczenia jeœli istnieje 
	@Override
	public boolean removeRental(Rental rental) {
		for (Rental rent : data.rentals)
			if(rent.equals(rental)) {
				data.rentals.remove(rent);
				return true;
			}
		return false;
	}

	//zwraca wypo¿yczenie o podanym indeksie
	@Override
	public Rental getRentalById(int id) {
		for(int i = 0 ; i < data.rentals.size() ; i ++) {
			if(data.rentals.get(i).getId() == id) return data.rentals.get(i);
		}
		return null;
	}

	//zwraca liste filmów których data oddania ju¿ minê³a
	@Override
	public ArrayList<Rental> getDepricatedRentals() {
		ArrayList<Rental> depricated = new ArrayList<>();
		Calendar currentDate = Calendar.getInstance();
		
		for(Rental rent: data.rentals) {
			if(currentDate.after(rent.getRentalExpireDate())) {
				depricated.add(rent);
			}
		}
		
		return depricated;
	}

	@Override
	public boolean changeSurcharge(float rate) {
		data.rate = rate;
		return true;
	}

	@Override
	public boolean addVideo(Video video) {
		data.videos.add(video);
		return false;
	}

	@Override
	public boolean removeVideo(Video video) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public boolean editVideoById(Video video, int id) {
		// TODO Auto-generated method stub
		return false;
	}

	@Override
	public ArrayList<Video> getVideos(int id, String name, Type type) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public ArrayList<Video> getAllVideos() {
		return data.videos;
	}

	@Override
	public ArrayList<Rental> getAllRentals() {
		return data.rentals;
	}
}
